rule Exploit_AndroidOS_Lotoor_B_2147756601_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.B!MTB"
        threat_id = "2147756601"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "onekeyrootseckill.sh" ascii //weight: 1
        $x_1_2 = "newrealroot" ascii //weight: 1
        $x_1_3 = "psneuter.script" ascii //weight: 1
        $x_1_4 = "start execute rootCmd= " ascii //weight: 1
        $x_1_5 = "rootThread sleep suc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_AndroidOS_Lotoor_B_2147756601_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.B!MTB"
        threat_id = "2147756601"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "com/mgyun/shua/su/ui/SplashActivity" ascii //weight: 3
        $x_1_2 = "RomasterSu" ascii //weight: 1
        $x_1_3 = "log.ibutian.com/Log/Report" ascii //weight: 1
        $x_1_4 = "libmgyunjni.so" ascii //weight: 1
        $x_1_5 = "/romastersu/update/update.apk" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_AndroidOS_Lotoor_A_2147786765_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.A!xp"
        threat_id = "2147786765"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "com.darkyrom.darkyconfig/cache/reboot recovery" ascii //weight: 1
        $x_1_2 = {65 63 68 6f [0-5] 70 72 69 6e 74 [0-16] 47 6f 69 6e 67 20 74 6f 20 69 6e 73 74 61 6c 6c}  //weight: 1, accuracy: Low
        $x_1_3 = "Are you sure to flash Rom" ascii //weight: 1
        $x_1_4 = "SUCCESS: Got root" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_AndroidOS_Lotoor_C_2147787021_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.C!MTB"
        threat_id = "2147787021"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Exploit" ascii //weight: 1
        $x_1_2 = "rootshell missing.." ascii //weight: 1
        $x_1_3 = "UniversalAndroot" ascii //weight: 1
        $x_1_4 = "remove_kit.sh" ascii //weight: 1
        $x_1_5 = "install_kit.sh missing" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_AndroidOS_Lotoor_D_2147794875_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.D!MTB"
        threat_id = "2147794875"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Try to hack task->cred" ascii //weight: 1
        $x_1_2 = "Attempt mtk_cmdq exploit" ascii //weight: 1
        $x_1_3 = "Attempting to inject code" ascii //weight: 1
        $x_1_4 = "voluntary_ctxt_switches" ascii //weight: 1
        $x_1_5 = "futex_exploit: Server started" ascii //weight: 1
        $x_1_6 = "get_user exploit" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_AndroidOS_Lotoor_B_2147798894_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.B!xp"
        threat_id = "2147798894"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/etc/vold.fstab" ascii //weight: 1
        $x_1_2 = "/data/data/eu.chainfire.gingerbreak/files/install.sh" ascii //weight: 1
        $x_1_3 = "devices/platform/msm_sdcc.2/mmc_host/mmc1" ascii //weight: 1
        $x_1_4 = "/data/data/eu.chainfire.gingerbreak/files/boomsh" ascii //weight: 1
        $x_1_5 = "Android Exploid Crew" ascii //weight: 1
        $x_1_6 = "Gingerbreak/Honeybomb" ascii //weight: 1
        $x_1_7 = "Exploit may take a while" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (6 of ($x*))
}

rule Exploit_AndroidOS_Lotoor_C_2147822370_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.C!xp"
        threat_id = "2147822370"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "%s/postroot_done" ascii //weight: 1
        $x_1_2 = "rootpak.tgz" ascii //weight: 1
        $x_1_3 = "katana file missing" ascii //weight: 1
        $x_1_4 = "isMountFlagEnabled" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (3 of ($x*))
}

rule Exploit_AndroidOS_Lotoor_F_2147822374_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.F!xp"
        threat_id = "2147822374"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 b5 42 69 85 b0 00 23 01 92 43 61 01 aa 80 68 04 49 02 93 03 93 ff f7 2c ef 05 b0 43 42 58 41 01 38 00 bd 29 6d 04 80 00 b5 43 69 83 b0}  //weight: 1, accuracy: High
        $x_1_2 = {00 20 04 e0 40 46 ff f7 3a ef 01 20 40 42 49 46 21 9a 0b 68 9a 42 09 d1 23 b0 3c bc 90 46}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (1 of ($x*))
}

rule Exploit_AndroidOS_Lotoor_G_2147822375_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/Lotoor.G!xp"
        threat_id = "2147822375"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {46 35 48 89 46 f9 44 4b 46 1a 68 34 49 a3 b0 13 68 78 44 79 44 91 46 21 93 ff f7 70 ef 80 46 00 28 52 d0 2f}  //weight: 1, accuracy: High
        $x_1_2 = {cc c0 08 56 14 c0 1c 56 08 c0 0a 00 00 08 38 b5 04 1c 45 69 ff f7}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (1 of ($x*))
}

