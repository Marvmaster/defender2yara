rule Exploit_AndroidOS_CVE_2014_3153_B_2147828431_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:AndroidOS/CVE-2014-3153.B!MTB"
        threat_id = "2147828431"
        type = "Exploit"
        platform = "AndroidOS: Android operating system"
        family = "CVE-2014-3153"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 f0 16 ed 26 4d 00 21 06 94 07 90 02 9e 05 9f 01 91 03 91 7d 44 0c 1c 2e e0 38 1c 09 a9 ff f7 53 ff 03 90 00 28 13 d0 0a 20 06 9c ff f7 52 ee ff f7 20 ee 00 68 ff f7 2a ee 17 4b 02 1c 19 49 e0 58 79 44 a8 30 ff f7 28 ee 00 22 02 92 1b e0 09 9b 04 34 08 c6 07 9b 9c 42 0c db 01 99 28 1c 01 31 01 91 ff f7 3c ee 0b 4b 06 9a d0 58 54 30 ff f7 3c ee 03 9c 04 37 04 99 05 9a 8b 18 9f 42 cb d3 0a 20 ff f7 26 ee 02 98 0b b0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

