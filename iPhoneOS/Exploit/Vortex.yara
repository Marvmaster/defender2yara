rule Exploit_iPhoneOS_Vortex_B_2147748682_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.B!MTB"
        threat_id = "2147748682"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/Applications/Cydia.app" ascii //weight: 1
        $x_1_2 = "Yalu/nexploit.c" ascii //weight: 1
        $x_1_3 = "enableCydia" ascii //weight: 1
        $x_1_4 = "Exploit by @s1guza and @tihmstar" ascii //weight: 1
        $x_1_5 = "goJailbreak" ascii //weight: 1
        $x_1_6 = "HDPCydiaManager" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (5 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_C_2147748716_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.C"
        threat_id = "2147748716"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "stole the kernel's credentials" ascii //weight: 1
        $x_1_2 = "v0rtex" ascii //weight: 1
        $x_1_3 = "/.cydia_no_stash" ascii //weight: 1
        $x_1_4 = "mach_port_request_notification(fakeport)" ascii //weight: 1
        $x_1_5 = "exploit failed" ascii //weight: 1
        $x_1_6 = "/Applications/Cydia.app" ascii //weight: 1
        $x_1_7 = "fucksigningservices" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (6 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_D_2147749021_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.D!MTB"
        threat_id = "2147749021"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/Etason JB/Etason JB/patchfinder.c" ascii //weight: 1
        $x_1_2 = "betterWorkingAndShit" ascii //weight: 1
        $x_1_3 = "/Applications/Cydia.app/" ascii //weight: 1
        $x_1_4 = "Etason JB/Etason JB/exploit.m" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_D_2147749021_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.D!MTB"
        threat_id = "2147749021"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6a 61 69 6c 62 72 65 61 6b 20 65 78 70 6c 6f 69 74 73 20 62 79 20 40 65 76 61 64 33 72 73 [0-2] 67 72 61 70 68 69 63 20 64 65 73 69 67 6e 20 62 79 20 40 53 75 72 65 6e 69 78}  //weight: 1, accuracy: Low
        $x_1_2 = "activate it before it can be used with evasi0n" ascii //weight: 1
        $x_1_3 = "Injecting evasi0n app (1/2)..." ascii //weight: 1
        $x_1_4 = {68 74 74 70 3a 2f 2f 63 6e 25 64 2e 65 76 61 73 69 30 6e 2e 63 6f 6d [0-7] 69 70 61 2d 69 6e 66 6f 2e 70 6c 69 73 74}  //weight: 1, accuracy: Low
        $x_1_5 = "evasi0n-install/Cydia.tar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_E_2147749295_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.E"
        threat_id = "2147749295"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/.bearded_old_man_no_stash" ascii //weight: 1
        $x_1_2 = "/Yalu/exploit.m" ascii //weight: 1
        $x_1_3 = "/.cydia_no_stash" ascii //weight: 1
        $x_1_4 = "/Applications/Cydia.app" ascii //weight: 1
        $x_1_5 = "runExploit" ascii //weight: 1
        $x_1_6 = "Your %@ is jailbroken" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_A_2147751430_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.A!MTB"
        threat_id = "2147751430"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "stole the kernel's credentials" ascii //weight: 2
        $x_1_2 = "Extracting Cydia" ascii //weight: 1
        $x_1_3 = "/.cydia_no_stash" ascii //weight: 1
        $x_1_4 = "DoubleH3lix" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_F_2147751817_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.F!MTB"
        threat_id = "2147751817"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/.cydia_no_stash" ascii //weight: 1
        $x_1_2 = "LaunchDaemons/dropbear.plist" ascii //weight: 1
        $x_1_3 = "smokecrack/exploit.m" ascii //weight: 1
        $x_1_4 = "/.installed_yaluX" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (3 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_F_2147751817_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.F!MTB"
        threat_id = "2147751817"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "running exploit" ascii //weight: 1
        $x_1_2 = "/Users/sxx/GitProject/sockH3lix/sockH3lix/sock_port_exploit.c" ascii //weight: 1
        $x_1_3 = "(bash -c \"su -c uicache mobile;killall backboardd;\")&" ascii //weight: 1
        $x_1_4 = "Extracting Cydia..." ascii //weight: 1
        $x_1_5 = "kexec: allocating fake client" ascii //weight: 1
        $x_1_6 = "extractPayloadFromIM4P" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_G_2147752530_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.G!MTB"
        threat_id = "2147752530"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "jbreak/source/jailbreak.m" ascii //weight: 1
        $x_1_2 = "pspawn_payload_xpcproxy.log" ascii //weight: 1
        $x_1_3 = "com.saurik.Cydia/lists" ascii //weight: 1
        $x_1_4 = "Applications/Cydia.app" ascii //weight: 1
        $x_1_5 = "mac/Downloads/jbreak" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (4 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_J_2147753506_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.J!MTB"
        threat_id = "2147753506"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "v0rtex was successful" ascii //weight: 2
        $x_3_2 = "com.abcydia.g0blin" ascii //weight: 3
        $x_1_3 = "applicationDidEnterBackground:" ascii //weight: 1
        $x_1_4 = "haoerloveyou@me.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (
            ((1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Exploit_iPhoneOS_Vortex_H_2147759847_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.H!MTB"
        threat_id = "2147759847"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Inject executables to trust cache" ascii //weight: 1
        $x_1_2 = "killing pid %u:" ascii //weight: 1
        $x_1_3 = "/private/var/tmp/wav%u_%uchans.wav" ascii //weight: 1
        $x_1_4 = "Usage: inject /full/path/to/executable" ascii //weight: 1
        $x_1_5 = "_set_tfp0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (4 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_H_2147759847_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.H!MTB"
        threat_id = "2147759847"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "checkra1n" ascii //weight: 1
        $x_1_2 = "Freya/exploits/SockPuppet" ascii //weight: 1
        $x_1_3 = "/tmp/.jailbroken_freya" ascii //weight: 1
        $x_1_4 = "fakeportData" ascii //weight: 1
        $x_1_5 = "/tmp/.needuicache" ascii //weight: 1
        $x_1_6 = "/var/log/pspawn_payload.log" ascii //weight: 1
        $x_1_7 = "/var/tmp/.pspawn_disable_loader" ascii //weight: 1
        $x_1_8 = "LaunchDaemons/io.pangu93.loader.plist" ascii //weight: 1
        $x_1_9 = "/tmp/pgloader" ascii //weight: 1
        $x_1_10 = "/.installed_kok3shi" ascii //weight: 1
        $x_1_11 = "p0laris/p0laris/Code/Kernel Exploit/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (3 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_C_2147788048_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.C!MTB"
        threat_id = "2147788048"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "setExploitProgress" ascii //weight: 1
        $x_1_2 = "sslv3 rollback attack" ascii //weight: 1
        $x_1_3 = "Jailbreak" ascii //weight: 1
        $x_1_4 = "id-tc26-wrap-gostr3412-2015-kuznyechik-kexp15" ascii //weight: 1
        $x_1_5 = "_dup_user_data" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_E_2147788428_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.E!MTB"
        threat_id = "2147788428"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2d e9 f0 45 81 b0 42 f6 6e 59 44 f2 26 21 c0 f2 04 09 40 f6 57 23 f9 44 c4 f2 b5 01 ce f2 35 13 d9 f8 00 00 bf f3 5b 8f 00 90 4f f2 da 1c 42 f6 f8 30 c0 f2 03 0c c2 f2 99 10 fc 44 02 46 9a 42 0c d0 8a 42 3c d0 82 42 f9 d1 00 9a 00 2a 0a 46 04 bf 40 f6 57 22 ce f2 35 12}  //weight: 1, accuracy: High
        $x_1_2 = "/Applications/Cydia.app" ascii //weight: 1
        $x_1_3 = "enableCydia" ascii //weight: 1
        $x_1_4 = "goJailbreak" ascii //weight: 1
        $x_1_5 = "exploit" ascii //weight: 1
        $x_1_6 = "HDPCydiaManager" ascii //weight: 1
        $x_1_7 = "HDPOffsetEntryProtocol" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (5 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_I_2147812155_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.I!MTB"
        threat_id = "2147812155"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ExploitResult dumdumdum::RunDUMDUMDUMation" ascii //weight: 1
        $x_1_2 = "Running time_waste" ascii //weight: 1
        $x_1_3 = "SQLITE_FORCE_PROXY_LOCKING" ascii //weight: 1
        $x_1_4 = "Triggering bug" ascii //weight: 1
        $x_1_5 = "get fakeport" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (all of ($x*))
}

rule Exploit_iPhoneOS_Vortex_A_2147815865_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.A!xp"
        threat_id = "2147815865"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/meridian/logs/%@-%lu" ascii //weight: 1
        $x_1_2 = "process spawned with pid %d" ascii //weight: 1
        $x_1_3 = "[inject] found at: %llx" ascii //weight: 1
        $x_1_4 = "Payload injected successfully" ascii //weight: 1
        $x_1_5 = "running v0rtex" ascii //weight: 1
        $x_1_6 = "export PATH=/meridian/bins:$PATH" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (5 of ($x*))
}

rule Exploit_iPhoneOS_Vortex_AA_2147852516_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:iPhoneOS/Vortex.AA!MTB"
        threat_id = "2147852516"
        type = "Exploit"
        platform = "iPhoneOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/.cydia_no_stash" ascii //weight: 1
        $x_1_2 = "/applications/cydia.app" ascii //weight: 1
        $x_1_3 = "io.pangu93.loader.plist" ascii //weight: 1
        $x_1_4 = "killall springboard" ascii //weight: 1
        $x_1_5 = "iosurfaceroot" ascii //weight: 1
        $x_1_6 = "starting exploit" ascii //weight: 1
        $x_1_7 = "exploit fail" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        ((uint32(0) == 0xfeedfacf) or (uint32(0) == 0xcffaedfe) or (uint32(0) == 0xfeedface) or (uint32(0) == 0xcefaedfe)) and
        (4 of ($x*))
}

