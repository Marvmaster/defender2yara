rule Exploit_Win32_CVE_2020_0796_2147754073_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/CVE-2020-0796!MTB"
        threat_id = "2147754073"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "CVE-2020-0796"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4c 8d 85 00 01 00 00 ba 20 00 00 00 48 8b c8 ff 15 c3 18 00 00 48 8b b5 00 01 00 00 b8 14 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {e9 9c 00 00 00 33 d2 c7 44 24 20 40 00 00 00 41 b9 00 30 00 00 41 b8 00 10 00 00 48 8b cb ff 15 41 1c 00 00 48 8b f8 48 85 c0 75 09 48 8d 0d 1a 20 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {eb 6c 48 89 b4 24 00 02 00 00 4c 8d 45 70 33 f6 48 8b d7 48 8b cb 48 89 74 24 20 44 8d 4e 6c ff 15 fd 1b 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

