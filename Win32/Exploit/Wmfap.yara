rule Exploit_Win32_Wmfap_A_2147599152_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Wmfap.A"
        threat_id = "2147599152"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Wmfap"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {eb 10 5a 4a 33 c9 66 b9 3c 01 80 34 0a 99 e2 fa eb 05 e8 eb ff ff ff 70 4c 99 99 99 c3 fd 38 a9 99 99 99 12 d9 95 12 e9 85 34 12 d9 91 12 41 12 ea a5 12 ed 87 e1 9a 6a 12 e7 b9 9a 62 12 d7 8d aa 74 cf ce c8 12 a6 9a 62 12 6b f3 97 c0 6a 3f ed 91 c0 c6 1a 5e 9d dc 7b 70 c0 c6 c7 12 54 12}  //weight: 1, accuracy: High
        $x_1_2 = {df bd 9a 5a 48 78 9a 58 aa 50 ff 12 91 12 df 85 9a 5a 58 78 9b 9a 58 12 99 9a 5a 12 63 12 6e 1a 5f 97 12 49 f3 9d c0 71 c9 99 99 99 1a 5f 94 cb cf 66 ce 65 c3 12 41 f3 98 c0 71 a4 99 99 99 1a 5f 8a cf df 19 a7 19 ec 63 19 af 19 c7 1a 75 b9 12 45 f3 b9 ca 66 ce 75 5e 9d 9a c5 f8 b7 fc 5e}  //weight: 1, accuracy: High
        $x_1_3 = {dd 9a 9d e1 fc 99 99 aa 59 c9 c9 ca cf c9 66 ce 65 12 45 c9 ca 66 ce 69 c9 66 ce 6d aa 59 35 1c 59 ec 60 c8 cb cf ca 66 4b c3 c0 32 7b 77 aa 59 5a 71 bf 66 66 66 de fc ed c9 eb f6 fa d8 fd fd eb fc ea ea 99 de fc ed ca e0 ea ed fc f4 dd f0 eb fc fa ed f6 eb e0 d8 99 ce f0 f7 dc e1 fc fa}  //weight: 1, accuracy: High
        $x_1_4 = {eb 10 5b 4b 33 c9 66 b9 25 01 80 34 0b 99 e2 fa eb 05 e8 eb ff ff ff 70 62 99 99 99 c6 fd 38 a9 99 99 99 12 d9 95 12 e9 85 34 12 f1 91 12 6e f3 9d c0 71 02 99 99 99 7b 60 f1 aa ab 99 99 f1 ee ea ab c6 cd 66 8f 12 71 f3 9d c0 71 1b 99 99 99 7b 60 18 75 09 98 99 99 cd f1 98 98 99 99 66 cf}  //weight: 1, accuracy: High
        $x_1_5 = {89 c9 c9 c9 c9 d9 c9 d9 c9 66 cf 8d 12 41 f1 e6 99 99 98 f1 9b 99 9d 4b 12 55 f3 89 c8 ca 66 cf 81 1c 59 ec d3 f1 fa f4 fd 99 10 ff a9 1a 75 cd 14 a5 bd f3 8c c0 32 7b 64 5f dd bd 89 dd 67 dd bd a4 10 c5 bd d1 10 c5 bd d5 10 c5 bd c9 14 dd bd 89 cd c9 c8 c8 c8 f3 98 c8 c8 66 ef a9 c8 66}  //weight: 1, accuracy: High
        $x_1_6 = {cf 9d 12 55 f3 66 66 a8 66 cf 91 ca 66 cf 85 66 cf 95 c8 cf 12 dc a5 12 cd b1 e1 9a 4c cb 12 eb b9 9a 6c aa 50 d0 d8 34 9a 5c aa 42 96 27 89 a3 4f ed 91 58 52 94 9a 43 d9 72 68 a2 86 ec 7e c3 12 c3 bd 9a 44 ff 12 95 d2 12 c3 85 9a 44 12 9d 12 9a 5c 32 c7 c0 5a 71 99 66 66 66 17 d7 97 75}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (3 of ($x*))
}

