rule Exploit_Win32_Senglot_B_2147598489_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.B"
        threat_id = "2147598489"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {90 33 c0 33 c9 eb 12 5e 66 b9 00 ef 8b fe 80 2e 02 80 36 0a 46 e2 f7 eb 05 e8 e9 ff ff ff e9 aa 00 00 00 5f 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 68 08 8b f7 6a 04 59 e8 4a 00 00 00 e2 f9 68 6f 6e 00 00 68 75 72 6c 6d 54 ff 16 8b e8 e8 34 00 00 00 83 ec 20 8b dc 6a 20 53 ff 56 04 c7 04 18 5c 63 70 75 c7 44 18 04 2e 65 78 65 c6 44 18 08 00 33 c0 50 50 53 57 50 ff 56 10 8b dc 6a 05 53 ff 56 08 ff 56 0c 51 56 8b 75 3c 8b 74 35 78 03 f5 56 8b 76 20 03 f5 33 c9 49 41 ad 03 c5 33 db 0f be 10 38 f2 74 08 c1 cb 0d 03 da 40 eb f1 3b 1f 75 e7 5e 8b 5e 24 03 dd 66 8b 0c 4b 8b 5e 1c 03 dd 8b 04 8b 03 c5 ab 5e 59 c3 e8 51 ff ff ff 8e 4e 0e ec ed db ec f8 98 fe 8a 0e 7e d8 e2 73 36 1a 2f 70}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_E_2147599240_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.E"
        threat_id = "2147599240"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {fc e8 44 00 00 00 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 04 75 e5 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 1c 8b 01 eb 89 5c 24 04 c3 31 c0 64 8b 40 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 68 08 eb 09 8b 80 b0 00 00 00 8b 68 3c 5f 31 f6 60 56 89 f8 83 c0 7b 50 68 7e d8 e2 73 68 98 fe 8a 0e 57 ff e7}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_F_2147599241_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.F"
        threat_id = "2147599241"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {33 c9 83 e9 a2 d9 ee d9 74 24 f4 5b 81 73 13 43 26 cb f8 83 eb fc e2 f4 a8 36 91 b2 70 ef ad 41 7f 27 4b cc 49 bf 29 02 a8 23 23 13 bc d9 34 88 0f bf 52 61 80 db f3 51 da bf 52 ea 9a b3 d9 11 c6 12 d9 21 d2 34 8a ea a9 83 d9 15 c4 c7 51 92 51 c1 72 62 21 34 1c 75 e9 52 04 36 8b 34 6d 62 21 34 a0 0b d4 e6 a1 c7 ae b7 0b 3e 59 78 56 24 38 56 0b 3e 84 34 9f ea 9c 9b 51 a2 0b 5e 51 a0 e9 76 34 ea d2 34 14 7d d9 7c 93 80 d8 bc 93}  //weight: 1, accuracy: High
        $x_1_2 = {ea da bc 91 ea 20 34 a5 e2 1c b1 d9 b1 b0 bb 0b 89 8a bf 52 61 59 79 5f 33 8c 40 05 9d 80 34 8a 0b db e6 ba 5c da bf 52 e2 1c ac 04 27 5a 81 d2 14 20 3f 64 e1 84 3c be 41 51 63 38 41 89 40 05 8d 1d bb 51 3d bb 91 37 a6 9e bc 56 19 bf bf 52 52 1a ef 02 32 8c ef ad 36 26 34 8e 31 89 40 05 91 8a 40 05 95 e9 7f fe e4 1a ca ab 30 88 e9 01 9e 08 e5 0b ca 38 51 61 a1 19 57 74 9e 25 40 15 04 ae ef 20 0e b9 fe 36 05 a8 da 21 12 da f8 37}  //weight: 1, accuracy: High
        $x_1_3 = {15 89 c6 21 15 bf d2 16 08 a8 da 31 15 b5 cd 2b 20 da e8 3b 0f 9f c7 37 02 da fa 2a 08 ae eb 3a 13 bf de 36 61 96 d0 33 05 96 d6 30 13 bb cd 2b 20 da ca 20 0d b7 d0 3c 61 8f ed 1e 25 b5 c8 3c 0d b5 de 36 35 b5 f9 3b 0d bf fe 52 90 37 52 bb c2 6c 09 a9 8a 36 4d aa 8c 6d 45 a4 95 6c 52 ae 8b 6c 45 a5 8c 6d 56 a3 88 7c 4d be 93 36 a6 cb f8 90 90 90 90}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_G_2147599242_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.G"
        threat_id = "2147599242"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {90 90 90 90 90 90 29 c9 83 e9 db d9 ee d9 74 24 f4 5b 81 73 13 a9 67 4a cc 83 eb fc e2 f4 55 8f 0c cc a9 67 c1 89 95 ec 36 c9 d1 66 a5 47 e6 7f c1 93 89 66 a1 2f 87 2e c1 f8 22 66 a4 fd 69 fe e6 48 69 13 4d 0d 63 6a 4b 0e 42 93 71 98 8d 63 3f 2f 22 38 6e cd 42 01 c1 c0 e2 ec 15 d0 a8 8c}  //weight: 1, accuracy: High
        $x_1_2 = {c1 d0 22 66 a1 45 f5 43 4e 0f 98 a7 2e 47 e9 57 cf 0c d1 68 c1 8c a5 ec 3a d0 04 ec 22 c4 40 6c 4a cc a9 ec 0a f8 ac 1b 4a cc a9 ec 22 f0 f6 56 bc ac ff 8c 47 a4 d7 bf a8 bf c1 ff b4 46 a7 30 b5 2b 41 89 b5 33 56 04 2b a0 ca 49 2f b4 cc 67 4a cc ff d0 90 90 90 90}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_H_2147599243_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.H"
        threat_id = "2147599243"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {90 90 90 90 eb 10 5b 4b 33 c9 66 b9 3c 01 80 34 0b 99 e2 fa eb 05 e8 eb ff ff ff 70 34 99 99 99 c3 12 6b aa 59 35 a4 01 99 99 99 ec 6f 18 75 51 99 99 99 12 6d 10 cf bd 71 0c 99 99 99 aa 42 10 9f 66 af f1 17 d7 97 75 71 34 99 99 99 10 df 91 f1 f5 f5 99 99 f1 f6 f7 b7 fd f1 ec eb f5 f4 cd}  //weight: 1, accuracy: High
        $x_1_2 = {66 cf 91 10 df 9d 66 af f1 e7 41 7b ea 71 11 99 99 99 10 df 95 66 af f1 01 67 13 97 71 e0 99 99 99 10 df 8d 66 af f1 bc 29 66 5b 71 f3 99 99 99 10 df 81 66 ef 9d f1 af 83 b6 e9 71 c3 99 99 99 10 df 89 f3 fc f1 ea b7 fc e1 10 ff 85 66 ef 85 66 cf 81 aa 50 c8 c8 66 ef 85 66 ef bd c8 66 cf}  //weight: 1, accuracy: High
        $x_1_3 = {89 aa 50 c8 66 ef 85 66 cf 8d 66 cf 95 70 19 99 99 99 cc cf fd 38 a9 99 99 99 1c 59 e1 95 12 d9 95 12 e9 85 34 12 f1 91 72 90 12 d9 ad 12 31 21 99 99 99 12 5c c7 c4 5b 9d 99 ca cc cf ce 12 f5 bd 81 12 dc a5 12 cd 9c e1 9a 4c 12 d3 81 12 c3 b9 9a 44 7a ab d0 12 ad 12 9a 6c aa 66 65 aa 59}  //weight: 1, accuracy: High
        $x_1_4 = {35 a3 5d ed 9e 58 56 94 9a 61 72 6b a2 e5 bd 8d ec 78 12 c3 bd 9a 44 ff 12 95 d2 12 c3 85 9a 44 12 9d 12 9a 5c 72 9b aa 59 12 4c c6 c7 c4 c2 5b 9d 99 71 50 67 66 66}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_I_2147599244_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.I"
        threat_id = "2147599244"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {43 43 43 43 eb 43 56 57 8b 45 3c 8b 54 05 78 01 ea 52 8b 52 20 01 ea 31 c0 31 c9 41 8b 34 8a 01 ee 31 ff c1 cf 13 ac 01 c7 85 c0 75 f6 39 df 75 ea 5a 8b 5a 24 01 eb 66 8b 0c 4b 8b 5a 1c 01 eb 8b 04 8b 01 e8 5f 5e ff e0 fc 31 c0 64 8b 40 30}  //weight: 1, accuracy: High
        $x_1_2 = {8b 40 0c 8b 70 1c ad 8b 68 08 31 c0 66 b8 6c 6c 50 68 33 32 2e 64 68 77 73 32 5f 54 bb 71 a7 e8 fe e8 90 ff ff ff 89 ef 89 c5 81 c4 70 fe ff ff 54 31 c0 fe c4 40 50 bb 22 7d ab 7d e8 75 ff ff ff 31 c0 50 50 50 50 40 50 40 50 bb a6 55 34 79}  //weight: 1, accuracy: High
        $x_1_3 = {e8 61 ff ff ff 89 c6 31 c0 50 50 35 02 01 70 cc fe cc 50 89 e0 50 6a 10 50 56 bb 81 b4 2c be e8 42 ff ff ff 31 c0 50 56 bb d3 fa 58 9b e8 34 ff ff ff 58 60 6a 10 54 50 56 bb 47 f3 56 c6 e8 23 ff ff ff 89 c6 31 db 53 68 2e 63 6d 64 89 e1 41}  //weight: 1, accuracy: High
        $x_1_4 = {31 db 56 56 56 53 53 31 c0 fe c4 40 50 53 53 53 53 53 53 53 53 53 53 6a 44 89 e0 53 53 53 53 54 50 53 53 53 43 53 4b 53 53 51 53 87 fd bb 21 d0 05 d0 e8 df fe ff ff 5b 31 c0 48 50 53 bb 43 cb 8d 5f e8 cf fe ff ff 56 87 ef bb 12 6b 6d d0 e8 c2 fe ff ff 83 c4 5c 61 eb 89 90 90 90 90}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_J_2147599245_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.J"
        threat_id = "2147599245"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5a 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 40 08 8b d8 8b 73 3c 8b 74 1e 78 03 f3 8b 7e 20 03 fb 8b 4e}  //weight: 1, accuracy: High
        $x_1_2 = {14 33 ed 56 57 51 8b 3f 03 fb 8b f2 6a 0e 59 f3 a6 74 08 59}  //weight: 1, accuracy: High
        $x_1_3 = {45 e2 e9 59 5f 5e 8b cd 8b 46 24 03 c3 d1 e1 03 c1 33 c9 66 8b 08 8b 46 1c 03 c3 c1 e1 02 03 c1 8b 00 03 c3 8b fa 8b f7 83 c6 0e 8b d0 6a 04 59 e8 6a 00 00 00 83 c6 0d 52 56 ff 57 fc 5a 8b d8 6a 01 59 e8 57 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {83 c6 13 56 46 80 3e 80 75 fa 80 36 80 5e 83 ec 40 8b dc c7 03 63 6d 64 20 43 43 43 43 66 c7 03 2f 63 43 43 c6 03 20 43 6a 20 53 ff 57 ec c7 04 03 5c 61 2e 65 c7 44 03 04 78 65 00 00 33 c0 50 50 53 56 50 ff 57 fc 8b dc 6a 00 53 ff 57 f0 68 51 24 40 00 58 ff d0 33 c0 ac 85 c0 75 f9 51 52 56 53 ff d2 5a 59 ab e2 ee 33 c0 c3 e8 0c ff ff}  //weight: 1, accuracy: High
        $x_1_5 = {ff 47 65 74 50 72 6f 63 41 64 64 72 65 73 73 00 47 65 74 53 79 73 74 65 6d 44 69 72 65 63 74 6f 72 79 41 00 57 69 6e 45 78 65 63 00 45 78 69 74 54 68 72 65 61 64 00 4c 6f 61 64 4c 69 62 72 61 72 79 41 00 75 72 6c 6d 6f 6e 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 41 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_K_2147599246_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.K"
        threat_id = "2147599246"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {30 70 00 43 90 90 90 90 90 90 ba 42 41 42 41 81 f2 11 11 11 11 41 39 11 75 fb 8b f1 8b f8 57 33 c9 66 b9 27 01 fc f3 a4 5f ff e7 90 53 50 53 50 90 33 c0 33 c9 eb 12 5e 66 b9 05 01 8b fe 80 2e 05 80 36 03 46 e2 f7 eb 05 e8 e9 ff ff ff ed 5c 8d 7b 44 8d 7c 32 80 05 fb 5a 8d 7a 28 05 fb 35}  //weight: 1, accuracy: High
        $x_1_2 = {cf 4f 47 b3 35 dd 3a 11 c2 1c 30 40 f6 7c 10 c7 cd 13 05 de 48 ed f1 3d e1 7b e9 62 8d 62 2c 05 e3 6a 8d 14 4d 8d 62 24 05 e3 8d 0c 8d 05 cb c5 5b 56 54 53 51 52 32 4c 54 54 08 45 3e 64 79 32 6b 80 6b 08 35 c8 6c 05 48 38 80 14 8d 48 14 8d}  //weight: 1, accuracy: High
        $x_1_3 = {78 24 b3 8d 48 10 ed 0f 8d 48 3c 93 48 84 8d 48 44 9b c1 92 52 12 f4 f0 8c 01 01 01 85 f4 0c 85 34 2c 44 01 d8 9b 58 c1 3a 1e 31 78 f0 71 01 01 01 8d 5c 2c 04 93 56 be 35 dd 55 55 56 ed 2c 55 01 d8 63 c1 a0 02 8e 12 f0 55 01 01 01 85 f4 0c}  //weight: 1, accuracy: High
        $x_1_4 = {85 34 2c 66 01 d8 c1 82 e0 e6 75 f0 48 01 01 01 56 01 d8 f0 d9 01 01 01 70 7c 7c 78 3e 31 31 79 79 79 32 66 7b 75 6f 72 6b 75 75 69 7b 6f 6c 6b 3c 7b 32 65 71 73 31 6f 6b 38 3a 38 37 32 65 69 6f 41 6b 80 78 74 71 6f 7c 43 53 55 38 3b 33 38 3b 3c 08 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_L_2147599247_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.L"
        threat_id = "2147599247"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5a 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 40 08 8b d8 8b 73 0d 0a 3c 8b 74 1e 78 03 f3 8b 7e 20 03 fb 8b 4e 14 33 ed 56 57 51 8b 3f 03 fb 8b f2 6a 0e 59 f3 a6 74 08 59 5f 83}  //weight: 1, accuracy: High
        $x_1_2 = {45 e2 e9 59 5f 5e 8b cd 8b 46 24 03 c3 d1 e1 03 c1 33 c9 66 8b 08 8b 46 1c 03 c3 c1 e1 02 03 c1 8b 00 03 c3 8b fa 8b f7 83 c6 0e 8b d0 6a 04 59 e8 6a 00 00 00 83 c6 0d 52 56}  //weight: 1, accuracy: High
        $x_1_3 = {ff 57 fc 5a 8b d8 6a 01 59 e8 57 00 00 00 83 c6 13 56 46 80 3e 80 75 fa 80 36 80 5e 83 ec 40 8b}  //weight: 1, accuracy: High
        $x_1_4 = {dc c7 03 63 6d 64 20 43 43 43 43 66 c7 03 2f 63 43 43 c6 03 20 43 6a 20 53 ff 57 ec c7 04 03 5c 61 2e 65 c7 44 03 04 78 65 00 00 33 c0 50 50 53 56 50 ff 57 fc 8b dc 6a 00 53 ff 57 f0 68 51 24 40 00 58 ff d0 33 c0 ac 85 c0 75 f9 51 52 56 53 ff d2 5a 59 ab e2 ee 33 c0 c3 e8 0c ff ff ff 47}  //weight: 1, accuracy: High
        $x_1_5 = {65 74 50 72 6f 63 41 64 64 72 65 73 73 00 47 65 74 53 79 73 74 65 6d 44 69 72 65 63 74 6f 72 79 41 00 57 69 6e 45 78 65 63 00 45 78 69 74 54 68 72 65 61 64 00 4c 6f 61 64 4c 69 62 72 61 72 79 41 00 75 72 6c 6d 6f 6e 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 41 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_M_2147599248_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.M"
        threat_id = "2147599248"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {e9 f3 00 00 00 90 90 90 90 5a 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 40 08 8b d8 8b 73 3c 8b 74 1e 78 03 f3 8b 7e 20 03 fb 8b 4e 14 33 ed 56 57 51 8b 3f 03 fb 8b f2 6a 0e 59 f3 a6 74 08 59 5f 83}  //weight: 1, accuracy: High
        $x_1_2 = {45 e2 e9 59 5f 5e 8b cd 8b 46 24 03 c3 d1 e1 03 c1 33 c9 66 8b 08 8b 46 1c 03 c3 c1 e1 02 03 c1 8b 00 03 c3 8b fa 8b f7 83 c6 0e 8b d0 6a 04 59 e8 6a 00 00 00 83 ee f3 52 56 ff 57}  //weight: 1, accuracy: High
        $x_1_3 = {fc 5a 8b d8 6a 01 59 e8 57 00 00 00 83 c6 13 56 46 80 3e 80 75 fa 80 36 80 5e 83 ec 40 8b dc c7 03 63 6d 64 20 43 43 43 43 66 c7 03 2f 63 43 43 c6 03 20 43 6a 20 53 ff 57 ec c7 04 03 5c 61 2e 65 c7 44 03 04 78 65 00 00 33 c0 50 50 53 56 50}  //weight: 1, accuracy: High
        $x_1_4 = {ff 57 fc 8b dc 6a 00 53 ff 57 f0 68 51 24 40 00 58 ff d0 33 c0 ac 85 c0 75 f9 51 52 56 53 ff d2 5a 59 ab e2 ee 33 c0 c3 e8 0c ff ff ff 47 65 74 50 72 6f 63 41 64 64 72 65 73 73 00 47 65 74 53 79 73 74 65 6d 44 69 72 65 63 74 6f 72 79 41 00}  //weight: 1, accuracy: High
        $x_1_5 = {57 69 6e 45 78 65 63 00 45 78 69 74 54 68 72 65 61 64 00 4c 6f 61 64 4c 69 62 72 61 72 79 41 00 75 72 6c 6d 6f 6e 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 41 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_M_2147599248_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.M"
        threat_id = "2147599248"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {90 90 90 90 90 90 33 c0 33 c9 eb 12 5e 66 b9 d2 01 8b fe 80 2e 19 80 36 01 46 e2 f7 eb 05 e8 e9 ff ff ff 8b f7 81 c6 18 00 00 00 81 ef 23 10 40}  //weight: 1, accuracy: High
        $x_1_2 = {00 e8 65 00 00 00 2b c9 51 ff d0 60 fc 33 c0 64 8b 40 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 8d 40 7c 8b 40 3c 8b d0 03 52 3c 8b 52 78 03 d0 8b 5a 20 03 d8 33 c9 8b e8 41 8b 3c 8b 03 f8 8b 37 03 77 04 3b 74 24 24 74 02 eb ed 8b 5a 24 03 dd 66 8b 0c 4b 8b 5a 1c 03 dd}  //weight: 1, accuracy: High
        $x_1_3 = {03 2c 8b 89 6c 24 1c 61 c2 04 00 55 8b ec 81 c4 a8 fe ff ff 68 98 d8 c3 d6 ff d6 e8 0b 00 00 00 55 52 4c 4d 4f 4e 2e 44 4c 4c 00 ff d0 93 68 b9 d4 d7 91 ff d6 e8 18 00 00 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 43 61 63 68 65 46 69 6c 65 41 00 53 ff d0 b9 04 00 00 00 93 53 51 68 c3 b1}  //weight: 1, accuracy: High
        $x_1_4 = {dd 65 ff d6 2b d2 52 ba d0 07 00 00 52 ff d0 2b d2 52 52 68 04 01 00 00 8d 85 fc fe ff ff c7 00 00 00 00 00 50 8d 87 aa 11 40 00 05 25 00 00 00 50 52 ff d3 68 b0 d1 d9 87 ff d6 8d 9d fc fe ff ff 53 ff d0 59 5b 40 49 0b c0 75 04 0b c9 75 ab 68 b7 d7 b5 d3 ff d6 93 57 8d bd b8 fe ff ff b8}  //weight: 1, accuracy: High
        $x_1_5 = {44 00 00 00 ab 8b c8 49 49 49 49 33 c0 f3 aa 5f eb 0b 8d 8f 9d 11 40 00 e8 15 00 00 00 90 8d 8d fc fe ff ff e8 09 00 00 00 68 95 ea d8 d7 ff d6 c9 c3 8d 85 a8 fe ff ff 50 8d 85 b8 fe ff ff 50 33 d2 52 52 52 52 52 52 51 52 ff d3 c3 69 65 78 70 6c 6f 72 65 2e 65 78 65 20}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_P_2147600889_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.P"
        threat_id = "2147600889"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ef ce e0 60 36 1a 2f ff 56 0c 51 56 8b 75 3c 8b 74 2e 78 75 00 83 ec 20 8b dc 6a 20 53 ff 56 04 70 1c ad 8b 68 08 8b f7 75 30 64 a1 30 00 00 00 8b 40 0c 8b c7 04 03 5c 61 2e 65 c7 75 30 5e 8b 5e 24 03 dd 66 8b da 40 eb f1 3b 1f 75 e7 e8 58 ff ff ff 8e 4e 0e}  //weight: 1, accuracy: High
        $x_1_2 = {43 43 43 43 43 43 e9 a3 00 00 75 35 66 30 59 e8 43 00 00 00 e2 f9 68 6f 6e 00 00 68 75 72 6c 6d 54 ff 16 95 e8 2e 75 30 30 30 04 78 65 00 00 33 c0 50 50 53 57 50 ff 56 10 8b dc 50 53 ff 56 08 56 8b 76 20 03 f5 33 c9 49 41 ad 03 c5 33 db 0f be 10 3a d6 74 08 c1 cb 75 8b 5e 1c 03 dd 8b 04 8b 03 c5 ab 5e 75 ec c1 79 e5 b8 98 75 0d 0d 0d 0d}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_Q_2147600890_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.Q"
        threat_id = "2147600890"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 5a 20 01 eb e3 35 49 8b 34 8b 01 ee 31 ff fc 31 c0 ac 38 56 51 ff d0 53 68 98 fe 8a 0e e8 2d 00 00 00 51 57 ff 66 b9 6f 6e 51 68 75 72 6c 6d 54 ff d0 50 90 90 90 90 90 90 e9 cc 00 00 00 5f e8 56 00 00 00 89 c3 50 68 8e 4e 0e ec e8 60 00 00 00 68 36 1a 2f 70 e8 46 00 00 00 31 c9 51 51 8d 37 56 8d 77 08 c9 49 90 90 53 68 7e d8 e2 73 e8 19 00 00 00 ff d0 55 56 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 68 08 89 e8 5e 5d c3 53 55 56 57 8b 6c 24 18 8b 45 3c 8b 54 05 78 01 ea 8b 4a 18 e0 74 07 c1 cf 0d 01 c7 eb f2 3b 7c 24 14 75 e1 8b 5a 24 01 eb 66 8b 0c 4b 8b 5a 1c 01 eb 8b 04 8b 01 e8 e9 02 00 00 00 31 c0 89 ea 5f 5e 5d 5b c3 e8 2f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_S_2147602247_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.S"
        threat_id = "2147602247"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 90 90 90 90 5a 64 a1 30 00 00 00 8b 40 0c 8b 70 1c ad 8b 40 08 8b d8 8b 73 3c 8b 74 1e 78 03 f3 8b 7e 20 03 fb 8b 4e 14 33 ed 56 57 51 8b 3f 03 fb 8b f2 6a 0e 59 f3 a6 74 08 59 5f 83 c7 04}  //weight: 1, accuracy: High
        $x_1_2 = {45 e2 e9 59 5f 5e 8b cd 8b 46 24 03 c3 d1 e1 03 c1 33 c9 66 8b 08 8b 46 1c 03 c3 c1 e1 02 03 c1 8b 00 03 c3 8b fa 8b f7 83 c6 0e 8b d0 6a 04 59 e8 6a 00 00 00 83 ee f3 52 56 ff 57 fc 5a 8b d8 6a 01 59 e8 57 00 00 00 83 c6 13 56 46 80 3e 80}  //weight: 1, accuracy: High
        $x_1_3 = {75 fa 80 36 80 5e 83 ec 40 8b dc c7 03 63 6d 64 20 43 43 43 43 66 c7 03 2f 63 43 43 c6 03 20 43 6a 20 53 ff 57 ec c7 04 03 5c 61 2e 65 c7 44 03 04 78 65 00 00 33 c0 50 50 53 56 50 ff 57 fc 8b dc 6a 00 53 ff 57 f0 68 51 24 40 00 58 ff d0 33}  //weight: 1, accuracy: High
        $x_1_4 = {c0 ac 85 c0 75 f9 51 52 56 53 ff d2 5a 59 ab e2 ee 33 c0 c3 e8 0c ff ff ff 47 65 74 50 72 6f 63 41 64 64 72 65 73 73 00 47 65 74 53 79 73 74 65 6d 44 69 72 65 63 74 6f 72 79 41 00 57 69 6e 45 78 65 63 00 45 78 69 74 54 68 72 65 61 64 00 4c}  //weight: 1, accuracy: High
        $x_1_5 = {6f 61 64 4c 69 62 72 61 72 79 41 00 75 72 6c 6d 6f 6e 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 46 69 6c 65 41}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_T_2147602614_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.T"
        threat_id = "2147602614"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {81 ef 22 10 40 00 fc 33 c0 64 8b 40 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 8d 40 7c 8b 40 3c e8 0b 00 00 00 0b c0 74 06 6a 00 ff d0 eb 01 c3 55 8b ec 81 c4 68 fe ff ff 89}  //weight: 1, accuracy: High
        $x_1_2 = {7d f8 89 45 fc 96 33 c0 83 c6 3c 66 ad 03 45 fc 96 ad 3d 50 45 00 00 0f 85 8e 02 00 00 8b 46 74 03 45 fc 96 83 c6 18 ad 89 45 f0 ad 89 45 ec ad 89 45 e8 ad 89 45 e4 c7 45 c0 04 49 32 d3 e8 6c 02 00 00 89 45 d4 c7 45 c0 8e 4e 0e ec e8 5d 02}  //weight: 1, accuracy: High
        $x_1_3 = {00 00 89 45 cc c7 45 c0 aa fc 0d 7c e8 4e 02 00 00 89 45 d0 c7 45 c0 0a 39 f7 56 e8 3f 02 00 00 89 45 d8 c7 45 c0 72 fe b3 16 e8 30 02 00 00 89 45 e0 c7 45 c0 b0 49 2d db e8 21 02 00 00 89 45 c8 c7 45 c0 7e d8 e2 73 e8 12 02 00 00 89 45 dc}  //weight: 1, accuracy: High
        $x_1_4 = {e8 0b 00 00 00 55 52 4c 4d 4f 4e 2e 44 4c 4c 00 8b 45 d4 ff d0 0b c0 75 15 e8 0b 00 00 00 55 52 4c 4d 4f 4e 2e 44 4c 4c 00 8b 45 cc ff d0 e8 18 00 00 00 55 52 4c 44 6f 77 6e 6c 6f 61 64 54 6f 43 61 63 68 65 46 69 6c 65 41 00 50 8b 45 d0 ff}  //weight: 1, accuracy: High
        $x_1_5 = {d0 89 45 c4 c7 45 f4 04 00 00 00 c6 85 bc fe ff ff 00 68 d0 07 00 00 8b 45 c8 ff d0 6a 00 6a 00 68 04 01 00 00 8d 85 bc fe ff ff 50 e8 04 01 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_A_2147605346_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.gen!A"
        threat_id = "2147605346"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5001"
        strings_accuracy = "Low"
    strings:
        $x_2500_1 = {66 81 38 4d 5a 74 08 83 c8 ff e9 ?? ?? 00 00 8b 50 3c 8d 0c 02 53 56 0f b7 71 14 03 f2 0f b7 51 06 8d 44 06 18 33 f6 66 3b d7 76 1d 8d 48 10 0f b7 da 8b 11 3b d7 74 0b 8b 41 04 03 c2 3b c6 76 02 8b f0 83 c1 28 4b 75 e9 68 04 01 00 00}  //weight: 2500, accuracy: Low
        $x_2500_2 = {57 68 80 00 00 00 6a 03 57 57 68 00 00 00 80 8d 85 ?? ?? ff ff 50 ff 15 ?? ?? ?? ?? 8b d8 83 fb ff 74 77 57 57 56 53 ff 15 ?? ?? ?? ?? 3b f0 75 48 57 53 ff 15 ?? ?? ?? ?? 3b c6 76 3c 6a 40 2b c6 68 00 10 00 00 8b f0 56 57 ff 15 ?? ?? ?? ?? 57 8d 8d ?? ?? ff ff 51 56 50 53}  //weight: 2500, accuracy: Low
        $x_1_3 = "http://vpnbox.net/1.exe" ascii //weight: 1
        $x_1_4 = "http://221.2.56.50/admin/patch.exe" ascii //weight: 1
        $x_1_5 = "http://lskdfjlerjvm.com/arm/exe.php" ascii //weight: 1
        $x_1_6 = "http://lskdfjlerjvm.com/arm3/exe.php" ascii //weight: 1
        $x_1_7 = "http://kassperskylabs.cn/spl/exe.php" ascii //weight: 1
        $x_1_8 = "219.136.252.133/jiao.exe" ascii //weight: 1
        $x_1_9 = "http://seal.w115.4888a.com/3.exe" ascii //weight: 1
        $x_1_10 = "http://www.hack006.com/muma.exe" ascii //weight: 1
        $x_1_11 = "http://web.59cn.cn/leiying/11.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (
            ((2 of ($x_2500_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_Win32_Senglot_V_2147605513_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.V"
        threat_id = "2147605513"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {eb 54 8b 75 3c 8b 74 35 78 03 f5 56 8b 76 20 03 f5 33 c9 49 41 ad 33 db 36 0f be 14 28 38 f2 74 08 c1 cb 0d 03 da 40 eb ef 3b df 75 e7 5e 8b 5e 24 03 dd 66 8b 0c 4b 8b 5e 1c 03 dd 8b 04 8b 03 c5 c3 75 72 6c 6d 6f 6e 2e 64 6c 6c 00 43 3a 5c 55 2e 65 78 65 00 33 c0 64 03 40 30 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 8d 40 7c 8b 40 3c 95 bf 8e 4e 0e ec e8 84 ff ff ff 83 ec 04 83 2c 24 3c ff d0 95 50 bf 36 1a 2f 70 e8 6f ff ff ff 8b 54 24 fc 8d 52 ba 33 db 53 53 52 eb 24 53 ff d0 5d bf 98 fe 8a 0e e8 53 ff ff ff 83 ec 04 83 2c 24 62 ff d0 bf 7e d8 e2 73 e8 40 ff ff ff 52 ff d0 e8 d7 ff ff ff 68 74 74 70 3a 2f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

rule Exploit_Win32_Senglot_AH_2147609142_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Win32/Senglot.AH"
        threat_id = "2147609142"
        type = "Exploit"
        platform = "Win32: Windows 32-bit platform"
        family = "Senglot"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 40 0c 8b 70 1c ad 8b 40 08 8b d8 8b 73 3c 8b 74 1e 78 03 f3 8b 7e 20 03 fb 8b 4e 14 33 ed 56 57 51 8b 3f 03 fb 8b f2 6a 0e 59 f3 a6 74 08 59 5f 83 ?? ?? 45 e2 e9 59 5f 5e 8b cd 8b 46 24 03 c3 d1 e1 03 c1 33 c9 66 8b 08 8b 46 1c 03 c3 c1 e1 02 03 c1 8b 00 03 c3 8b fa 8b f7 83 c6 0e 8b d0 6a 04 59 e8 6a 00 00 00 83 ?? ?? 52 56 ff 57 fc 5a 8b d8 6a 01 59 e8 57 00 00 00 83 c6 13 56 46 80 3e 80 75 fa 80 36 80 5e 83 ec 40 8b dc c7 03 63 6d 64 20 43 43 43 43 66 c7 03 2f 63 43 43 c6 03 20 43 6a 20 53 ff 57 ec}  //weight: 1, accuracy: Low
        $x_1_2 = {33 c0 50 50 53 56 50 ff 57 fc 8b dc 6a 00 53 ff 57 f0 68 51 24 40 00 58 ff d0 33 c0 ac 85 c0 75 f9 51 52 56 53 ff d2 5a 59 ab e2 ee 33 c0 c3 e8 0c}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint16(0) == 0x5a4d) and
        (all of ($x*))
}

