rule Exploit_Linux_CVE_2012_0056_A_2147824651_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/CVE-2012-0056.A!xp"
        threat_id = "2147824651"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "CVE-2012-0056"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "objdump -d /bin/su" ascii //weight: 1
        $x_1_2 = "mempodipper.c" ascii //weight: 1
        $x_1_3 = "by zx2c4" ascii //weight: 1
        $x_1_4 = "-o 0x402178" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_Linux_CVE_2012_0056_B_2147919806_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/CVE-2012-0056.B!MTB"
        threat_id = "2147919806"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "CVE-2012-0056"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {64 72 65 73 73 20 6d 61 6e 75 61 6c 6c 79 2e 00 00 5b 2d 5d 20 55 73 61 67 65 3a 20 25 73 20 2d 6f 20 41 44 44 52 45 53 53 0a 5b 2d 5d 20 45 78 61 6d 70 6c 65 3a 20 25 73 20 2d 6f 20 30 78 34 30 32 31 37 38 0a 00 00 00 5b 2b 5d 20 52 65 73 6f 6c 76 65 64 20 63 61 6c 6c 20 61 64 64 72 65 73 73 20 74 6f 20 30 78 25 6c 78 2e 0a 00 5b 2b 5d 20 43 61 6c 63 75}  //weight: 2, accuracy: High
        $x_2_2 = {72 72 65 64 20 66 64 20 69 6e 20 70 61 72 65 6e 74 2e 00 5b 2b 5d 20 52 65 63 65 69 76 65 64 20 66 64 20 61 74 20 25 64 2e 0a 00 5b 2d 5d 20 72 65 63 76 5f 66 64 00 00 00 5b 2b 5d 20 41 73 73 69 67 6e 69 6e 67 20 66 64 20 25 64 20 74 6f 20 73 74 64 65 72 72 2e 0a 00 5b 2b 5d 20 53 65 65 6b 69 6e 67 20 74 6f 20 6f}  //weight: 2, accuracy: High
        $x_1_3 = "jdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed 's/^[0]*\\([^0]*\\)/0x\\1/'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

