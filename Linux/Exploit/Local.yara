rule Exploit_Linux_Local_A_2147649981_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Local.gen!A"
        threat_id = "2147649981"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Local"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "[-] check ur uid" ascii //weight: 4
        $x_2_2 = "[-] mprotect()" ascii //weight: 2
        $x_2_3 = "[-] socket()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_Linux_Local_B_2147649982_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Local.gen!B"
        threat_id = "2147649982"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Local"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "chown root:root %s && chmod 4755 %s && rm -rf %s && kill -USR1 %d" ascii //weight: 4
        $x_5_2 = "#/etc/cron.d/core suid_dumpable exploit" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_Linux_Local_C_2147650010_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Local.gen!C"
        threat_id = "2147650010"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Local"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "|- something went w0rng (invalid value)" ascii //weight: 3
        $x_2_2 = "| usage: %s <negative value> " ascii //weight: 2
        $x_2_3 = "|- the time has come to push the button... " ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_Linux_Local_D_2147654355_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Local.gen!D"
        threat_id = "2147654355"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Local"
        severity = "Critical"
        info = "gen: malware that is detected using a generic signature"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "exec ./insert_shellcode %i" ascii //weight: 4
        $x_1_2 = "LD_DEBUG" ascii //weight: 1
        $x_1_3 = "/usr/bin/newgrp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

rule Exploit_Linux_Local_A_2147822363_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Local.A!xp"
        threat_id = "2147822363"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Local"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "hoagie_udp_sendmsg.c - linux root <= 2.6.19 local" ascii //weight: 1
        $x_1_2 = "-andi / void.at" ascii //weight: 1
        $x_1_3 = "set_current_task_uids_gids_to_zero" ascii //weight: 1
        $x_1_4 = {66 89 45 ca 8d 45 c8 89 45 d8 c7 45 dc 10 00 00 00 c7 44 24 14 00 00 00 00 c7 44 24 10 00 00 00 00 c7 44 24 0c 32 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

