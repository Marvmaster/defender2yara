rule Exploit_Linux_Lotoor_A_2147755878_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.A!MTB"
        threat_id = "2147755878"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_4_1 = {43 48 6a 58 78 44 a8 32 11 1c 02 92 ff f7 58 eb 03 9b 05 99 07 9a 58 18 10 18 11 99 ee 9a ff f7 9e eb 49 aa 93 69 38 1c 94 61 53 60}  //weight: 4, accuracy: High
        $x_1_2 = "kill adbd manually... somehow" ascii //weight: 1
        $x_1_3 = "/data/local/tmp/freevo.dmp" ascii //weight: 1
        $x_1_4 = "Payload verification failed." ascii //weight: 1
        $x_1_5 = "Unable to exploit device" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_Linux_Lotoor_BA_2147767633_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.BA!MTB"
        threat_id = "2147767633"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/tmp/sendfile.XXXXXX" ascii //weight: 1
        $x_1_2 = {72 65 71 75 69 72 65 73 5f 6e 75 6c 6c 5f 70 61 67 65 00 67 65 74 5f 65 78 70 6c 6f 69 74 5f 73 74 61 74 65 5f 70 74 72}  //weight: 1, accuracy: High
        $x_1_3 = "unable to find a vulnerable domain" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Linux_Lotoor_B_2147793496_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.B!MTB"
        threat_id = "2147793496"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Failed to trigger the vulnerability." ascii //weight: 1
        $x_1_2 = "This kernel is still vulnerable, but I can't be bothered to write the exploit." ascii //weight: 1
        $x_1_3 = "/proc/self/fd/%d" ascii //weight: 1
        $x_1_4 = "MooseCox: Linux <= 2.6.31.5 pipe local root" ascii //weight: 1
        $x_1_5 = "Using older-er pipe_inode_info layout" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Linux_Lotoor_A_2147827707_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.A!xp"
        threat_id = "2147827707"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "[+] setting up exploit payload" ascii //weight: 1
        $x_1_2 = "creating PF_CAN socket" ascii //weight: 1
        $x_1_3 = "[-] exploit failed" ascii //weight: 1
        $x_1_4 = "do ipcrm -m $shmid > /dev/null 2>" ascii //weight: 1
        $x_1_5 = "[+] resolved symbol %s to %p" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Exploit_Linux_Lotoor_B_2147828134_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.B!xp"
        threat_id = "2147828134"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Exploit works only at some 2.6.x kernels." ascii //weight: 1
        $x_1_2 = "Yes, you're vulnerable too." ascii //weight: 1
        $x_1_3 = "gayros" ascii //weight: 1
        $x_1_4 = "Where did you find this, www.ancientexploits.org" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Linux_Lotoor_D_2147828135_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.D!xp"
        threat_id = "2147828135"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "[*] Android local root exploid" ascii //weight: 1
        $x_1_2 = "[+] Using basedir=%s, path=%s" ascii //weight: 1
        $x_1_3 = "[+] opening NETLINK_KOBJECT_UEVENT socket" ascii //weight: 1
        $x_1_4 = "[*] Try to invoke hotplug now, clicking at the wireless" ascii //weight: 1
        $x_1_5 = "[*] settings, plugin USB key etc." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Exploit_Linux_Lotoor_C_2147828993_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.C!xp"
        threat_id = "2147828993"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "xp: an internal category used to refer to some threats"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "sd@fucksheep.org" ascii //weight: 1
        $x_1_2 = "[0m y3r 422 12 n07 3r337 3nuPh" ascii //weight: 1
        $x_1_3 = "[0m Try increase nrpages" ascii //weight: 1
        $x_1_4 = "[0m j00 1u(k7 k1d" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_Linux_Lotoor_F_2147928898_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/Lotoor.F!MTB"
        threat_id = "2147928898"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "Lotoor"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {80 3d 14 9c 04 08 00 75 3f b8 f4 9a 04 08 2d f0 9a 04 08 c1 f8 02 8d 58 ff a1 10 9c 04 08 39 c3 76 1f 8d b4 26 00 00 00 00 83 c0 01 a3 10 9c 04 08 ff 14 85 f0 9a 04 08 a1 10 9c 04 08 39 c3 77 e8 c6 05 14 9c 04 08 01 83 c4 04}  //weight: 1, accuracy: High
        $x_1_2 = {8b 45 e0 8b 10 a1 18 9c 04 08 39 c2 0f 85 e1 00 00 00 8b 45 e0 83 c0 04 8b 10 a1 18 9c 04 08 39 c2 0f 85 cc 00 00 00 8b 45 e0 83 c0 08 8b 10 a1 18 9c 04 08 39 c2}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

