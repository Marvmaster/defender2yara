rule Exploit_Linux_CVE_2010_4077_A_2147821101_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/CVE-2010-4077.A!MTB"
        threat_id = "2147821101"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "CVE-2010-4077"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {83 45 f8 01 83 7d f8 09 7e ?? c7 44 24 08 a0 01 00 00 c7 44 24 04 42 00 00 00 c7 04 24 47 88 04 08 e8 ?? ?? ff ff 89 45 f0 83 7d f0 ff 75 ?? c7 04 24 50 88 04 08 e8 ?? ?? ff ff c7 04 24 ff ff ff ff}  //weight: 1, accuracy: Low
        $x_1_2 = {8b 45 f8 c1 e0 02 89 c2 8d 45 a0 83 c0 2c 01 d0 c7 44 24 08 04 00 00 00 89 44 24 04 8b 45 f0 89 04 24 e8 ?? ?? ff ff 01 45 f4 83 45 f8 01 83 7d f8 09}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

