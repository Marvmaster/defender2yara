rule Exploit_Linux_CVE_2022_0995_A_2147914721_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Linux/CVE-2022-0995.A!MTB"
        threat_id = "2147914721"
        type = "Exploit"
        platform = "Linux: Linux platform"
        family = "CVE-2022-0995"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {77 4f 48 8b 85 70 dc ff ff 48 c1 e8 06 48 8d 14 c5 00 00 00 00 48 8d 8d b0 dc ff ff 48 01 ca 48 8b 32 48 8b 95 70 dc ff ff 83 e2 3f bf 01 00 00 00 89 d1 48 d3 e7 48 89 fa 48 8d 0c c5 00 00 00 00 48 8d 85 b0 dc ff ff 48 01 c8 48 09 f2 48 89 10 48 8d 85 b0 dc ff ff}  //weight: 1, accuracy: High
        $x_1_2 = {48 8b 8d 78 dc ff ff 8b 85 54 dc ff ff 48 63 d0 48 89 d0 48 c1 e0 02 48 01 d0 48 01 c0 48 01 d0 48 c1 e0 02 48 01 c8 48 83 c0 08 c7 00 01 00 00 00 83 85 54 dc ff ff 01 8b 85 6c dc ff ff 83 e8 01 39 85 54 dc ff ff 7c b7}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (uint32(0) == 0x464c457f) and
        (all of ($x*))
}

